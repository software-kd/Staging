$.getFlightResultOption = function () {
    return $.ajax({
        type: 'POST',
        url: '/Flight/FlightResultOption',
        cache: false,
        async: true,
        //contentType: 'json',
    }).promise();
};

var checkPairResult = function (grpTag, segTag, serviceSource) {
    // hardcode testing data
    //var list = JSON.parse('[{"Index":0,"Price":6609.00,"GroupTag":"AF-KL660900","OutBound":["AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335"],"InBound":["KL706-201701312145,KL809-201702012045","KL706-201701312145,KL809-201702012045","KL706-201701312145,KL809-201702012045","KL706-201701312145,KL809-201702012045","KL706-201701312145,KL809-201702012045","KL706-201701312145,KL809-201702012045","KL706-201701312145,KL809-201702012045","KL706-201701312145,KL809-201702012045"]},{"Index":1,"Price":6616.00,"GroupTag":"KL661600","OutBound":["KL810-201612312350,KL705-201701011035"],"InBound":["KL706-201701312145,KL809-201702012045"]},{"Index":2,"Price":6648.00,"GroupTag":"AF-KL664800","OutBound":["AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335"],"InBound":["KL9329-201701311650,KL792-201701312110,KL809-201702012045","KL9329-201701311650,KL792-201701312110,KL809-201702012045","KL9329-201701311650,KL792-201701312110,KL809-201702012045","KL9329-201701311650,KL792-201701312110,KL809-201702012045","KL9329-201701311650,KL792-201701312110,KL809-201702012045","KL9329-201701311650,KL792-201701312110,KL809-201702012045","KL9329-201701311650,KL792-201701312110,KL809-201702012045","KL9329-201701311650,KL792-201701312110,KL809-201702012045"]},{"Index":3,"Price":6652.00,"GroupTag":"AF-KL665200","OutBound":["AF8398-201612312350,AF1241-201701010930,AF442-201701012335"],"InBound":["KL706-201701312145,KL809-201702012045"]},{"Index":4,"Price":6655.00,"GroupTag":"KL665500","OutBound":["KL810-201612312350,KL705-201701011035"],"InBound":["KL9329-201701311650,KL792-201701312110,KL809-201702012045"]},{"Index":5,"Price":6673.00,"GroupTag":"MI-KL667300","OutBound":["MI341-201612312145,KL836-201701010130,KL705-201701011035"],"InBound":["KL706-201701312145,KL809-201702012045"]},{"Index":6,"Price":6687.00,"GroupTag":"AF668700","OutBound":["AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF6712-201612310840,AF8239-201612311625,AF442-201612312335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF8398-201612312350,AF1341-201701011040,AF442-201701012335","AF8398-201612312350,AF1141-201701011855,AF442-201701012335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF8398-201612312350,AF1641-201701011350,AF442-201701012335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF8233-201701011230,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF8398-201612312350,AF8239-201701011625,AF442-201701012335","AF6712-201612310840,AF1441-201612312030,AF442-201612312335","AF8398-201612312350,AF1741-201701011450,AF442-201701012335"],"InBound":["AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045"]},{"Index":7,"Price":6691.00,"GroupTag":"AF-KL669100","OutBound":["AF8398-201612312350,AF1241-201701010930,AF442-201701012335"],"InBound":["KL9329-201701311650,KL792-201701312110,KL809-201702012045"]},{"Index":8,"Price":6695.00,"GroupTag":"KL-AF669500","OutBound":["KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035","KL810-201612312350,KL705-201701011035"],"InBound":["AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045"]},{"Index":9,"Price":6712.00,"GroupTag":"MI-KL671200","OutBound":["MI341-201612312145,KL836-201701010130,KL705-201701011035"],"InBound":["KL9329-201701311650,KL792-201701312110,KL809-201702012045"]},{"Index":10,"Price":6730.00,"GroupTag":"AF673000","OutBound":["AF8398-201612312350,AF1241-201701010930,AF442-201701012335","AF8398-201612312350,AF1241-201701010930,AF442-201701012335","AF8398-201612312350,AF1241-201701010930,AF442-201701012335","AF8398-201612312350,AF1241-201701010930,AF442-201701012335","AF8398-201612312350,AF1241-201701010930,AF442-201701012335","AF8398-201612312350,AF1241-201701010930,AF442-201701012335","AF8398-201612312350,AF1241-201701010930,AF442-201701012335","AF8398-201612312350,AF1241-201701010930,AF442-201701012335"],"InBound":["AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155"]},{"Index":11,"Price":6752.00,"GroupTag":"MI-KL-AF675200","OutBound":["MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035","MI341-201612312145,KL836-201701010130,KL705-201701011035"],"InBound":["AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155"]},{"Index":12,"Price":6854.00,"GroupTag":"EK685400","OutBound":["EK347-201612311910,EK247-201701010710","EK347-201612311910,EK247-201701010710"],"InBound":["EK248-201701310305,EK346-201702010410","EK248-201701310305,EK342-201702011015"]},{"Index":13,"Price":6954.00,"GroupTag":"EK695400","OutBound":["EK343-201612310110,EK247-201612310710","EK343-201612310110,EK247-201612310710"],"InBound":["EK248-201701310305,EK346-201702010410","EK248-201701310305,EK342-201702011015"]},{"Index":14,"Price":7036.00,"GroupTag":"MH-KL703600","OutBound":["MH609-201612312255,KL836-201701010130,KL705-201701011035"],"InBound":["KL706-201701312145,KL809-201702012045"]},{"Index":15,"Price":7075.00,"GroupTag":"MH-KL707500","OutBound":["MH609-201612312255,KL836-201701010130,KL705-201701011035"],"InBound":["KL9329-201701311650,KL792-201701312110,KL809-201702012045"]},{"Index":16,"Price":7115.00,"GroupTag":"MH-KL-AF711500","OutBound":["MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035","MH609-201612312255,KL836-201701010130,KL705-201701011035"],"InBound":["AF443-201701311740,AF8230-201702011020,AF8399-201702012045","AF443-201701311740,AF1640-201702011150,AF8399-201702012045","AF443-201701311740,AF8224-201702010910,AF6711-201702011155","AF443-201701311740,AF8228-201702010945,AF6711-201702011155","AF443-201701311740,AF8224-201702010910,AF8399-201702012045","AF443-201701311740,AF8228-201702010945,AF8399-201702012045","AF443-201701311740,AF1140-201702011650,AF8399-201702012045","AF443-201701311740,AF1440-201702011750,AF8399-201702012045","AF443-201701311740,AF1740-201702011240,AF8399-201702012045"]},{"Index":17,"Price":7164.00,"GroupTag":"QR716400","OutBound":["QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR853-201612310205,QR773-201612310815,QR6458-201612312105","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR849-201612312020,QR773-201701010815,QR6458-201701012105","QR849-201612312020,QR773-201701010815,QR6458-201701012105","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR849-201612312020,QR773-201701010815,QR6458-201701012105","QR849-201612312020,QR773-201701010815,QR6458-201701012105","QR849-201612312020,QR773-201701010815,QR6458-201701012105","QR849-201612312020,QR773-201701010815,QR6424-201701012025","QR849-201612312020,QR773-201701010815,QR6458-201701012105","QR853-201612310205,QR773-201612310815,QR6424-201612312025","QR849-201612312020,QR773-201701010815,QR6458-201701012105","QR849-201612312020,QR773-201701010815,QR6458-201701012105"],"InBound":["QR6485-201701311420,QR774-201702010415,QR848-201702020259","QR6485-201701311420,QR774-201702010415,QR852-201702020930","QR6485-201701311420,QR774-201702010415,QR848-201702020259","QR6478-201701312105,QR774-201702010415,QR852-201702020930","QR6478-201701312105,QR774-201702010415,QR848-201702020259","QR6459-201701311855,QR774-201702010415,QR852-201702020930","QR6485-201701311420,QR774-201702010415,QR852-201702020930","QR6425-201701311650,QR774-201702010415,QR852-201702020930","QR6485-201701311420,QR774-201702010415,QR852-201702020930","QR6478-201701312105,QR774-201702010415,QR852-201702020930","QR6478-201701312105,QR774-201702010415,QR848-201702020259","QR6459-201701311855,QR774-201702010415,QR852-201702020930","QR6459-201701311855,QR774-201702010415,QR848-201702020259","QR6425-201701311650,QR774-201702010415,QR852-201702020930","QR6425-201701311650,QR774-201702010415,QR848-201702020259","QR6459-201701311855,QR774-201702010415,QR848-201702020259","QR6485-201701311420,QR774-201702010415,QR848-201702020259","QR6425-201701311650,QR774-201702010415,QR848-201702020259","QR6459-201701311855,QR774-201702010415,QR852-201702020930","QR6478-201701312105,QR774-201702010415,QR852-201702020930","QR6478-201701312105,QR774-201702010415,QR848-201702020259","QR6459-201701311855,QR774-201702010415,QR852-201702020930","QR6459-201701311855,QR774-201702010415,QR848-201702020259","QR6425-201701311650,QR774-201702010415,QR852-201702020930","QR6485-201701311420,QR774-201702010415,QR852-201702020930","QR6425-201701311650,QR774-201702010415,QR852-201702020930","QR6459-201701311855,QR774-201702010415,QR848-201702020259","QR6425-201701311650,QR774-201702010415,QR848-201702020259","QR6478-201701312105,QR774-201702010415,QR852-201702020930","QR6425-201701311650,QR774-201702010415,QR848-201702020259","QR6485-201701311420,QR774-201702010415,QR848-201702020259","QR6478-201701312105,QR774-201702010415,QR848-201702020259"]},{"Index":18,"Price":7780.00,"GroupTag":"EY778000","OutBound":["EY411-201612311920,EY191-201701010840,EY5268-201701012105","EY413-201612310235,EY191-201612310840,EY5268-201612312105","EY413-201612310235,EY191-201612310840,EY5268-201612312105","EY413-201612310235,EY191-201612310840,EY5268-201612312105","EY413-201612310235,EY191-201612310840,EY5268-201612312105","EY411-201612311920,EY191-201701010840,EY5268-201701012105","EY411-201612311920,EY191-201701010840,EY5268-201701012105","EY411-201612311920,EY191-201701010840,EY5268-201701012105"],"InBound":["EY5273-201701311855,EY190-201701312340,EY418-201702012245","EY2510-201701311800,EY190-201701312340,EY418-201702012245","EY2514-201701311445,EY190-201701312340,EY418-201702012245","EY5269-201701311420,EY190-201701312340,EY418-201702012245","EY5273-201701311855,EY190-201701312340,EY418-201702012245","EY5269-201701311420,EY190-201701312340,EY418-201702012245","EY2514-201701311445,EY190-201701312340,EY418-201702012245","EY2510-201701311800,EY190-201701312340,EY418-201702012245"]},{"Index":19,"Price":8182.00,"GroupTag":"EY-JJ818200","OutBound":["EY413-201612310235,EY191-201612310840,EY5268-201612312105","EY411-201612311920,EY191-201701010840,EY5268-201701012105"],"InBound":["JJ3399-201701311835,EY190-201701312340,EY418-201702012245","JJ3399-201701311835,EY190-201701312340,EY418-201702012245"]},{"Index":20,"Price":8462.00,"GroupTag":"EY846200","OutBound":["EY411-201612311920,EY191-201701010840,EY5268-201701012105","EY413-201612310235,EY191-201612310840,EY5268-201612312105"],"InBound":["EY5228-201701311650,EY190-201701312340,EY418-201702012245","EY5228-201701311650,EY190-201701312340,EY418-201702012245"]},{"Index":21,"Price":21678.00,"GroupTag":"KL-AZ2167800","OutBound":["KL812-201612310840,AZ109-201612311805,AZ672-201612312145"],"InBound":["AZ673-201701311700,AZ108-201702010830,KL811-201702011155"]},{"Index":22,"Price":22355.00,"GroupTag":"MH-JJ-LA-BA2235500","OutBound":["MH4-201612310900,JJ8085-201612312210,JJ3400-201701011740","MH4-201612310900,JJ8085-201612312210,JJ3400-201701011740","MH4-201612310900,JJ8085-201612312210,JJ3400-201701011740","MH4-201612310900,JJ8085-201612312210,JJ3400-201701011740","MH4-201612310900,JJ8085-201612312210,JJ3400-201701011740"],"InBound":["LA3223-201701311535,BA3320-201701312345,MH1-201702012135","JJ3399-201701311835,JJ8387-201701312355,MH1-201702012135","JJ3399-201701311835,JJ8084-201701312345,MH1-201702012135","JJ3399-201701311835,BA3320-201701312345,MH1-201702012135","LA3223-201701311535,JJ8084-201701312345,MH1-201702012135"]},{"Index":23,"Price":22430.00,"GroupTag":"MH-AT-JJ2243000","OutBound":["MH150-201612311500,AT255-201701010345,AT213-201701011115","MH150-201612311500,AT255-201701010345,AT213-201701011115"],"InBound":["JJ3012-201701311535,JJ8084-201701312345,MH1-201702012135","JJ3012-201701311535,JJ8387-201701312355,MH1-201702012135"]},{"Index":24,"Price":22659.00,"GroupTag":"MH-AT-JJ2265900","OutBound":["MH4-201612310900,AT805-201612311915,AT213-201701011115","MH4-201612310900,AT805-201612311915,AT213-201701011115"],"InBound":["JJ3012-201701311535,JJ8387-201701312355,MH1-201702012135","JJ3012-201701311535,JJ8084-201701312345,MH1-201702012135"]},{"Index":25,"Price":22667.00,"GroupTag":"BA-TP-JJ2266700","OutBound":["BA34-201612310005,BA502-201612311530,TP73-201612312325","BA34-201612310005,BA502-201612311530,TP73-201612312325"],"InBound":["JJ3399-201701311835,JJ8387-201701312355,BA33-201702011855","JJ3399-201701311835,JJ8084-201701312345,BA33-201702011855"]},{"Index":26,"Price":22726.00,"GroupTag":"BA-TP-JJ2272600","OutBound":["BA34-201612310005,TP359-201612311340,TP73-201612312325"],"InBound":["JJ3399-201701311835,JJ8387-201701312355,BA33-201702011855"]},{"Index":27,"Price":22985.00,"GroupTag":"KL-TP2298500","OutBound":["KL812-201612310840,KL1697-201612312110,TP2543-201701011030"],"InBound":["TP78-201701312020,TP652-201702011100,KL809-201702012045"]},{"Index":28,"Price":23019.00,"GroupTag":"MH-AZ-JJ-BA2301900","OutBound":["MH4-201612310900,AZ207-201612311655,AZ672-201612312145"],"InBound":["JJ3386-201701310805,BA246-201701311730,MH3-201702011000"]},{"Index":29,"Price":23030.00,"GroupTag":"MH-TP-LA-JJ2303000","OutBound":["MH4-201612310900,TP369-201612311955,TP2543-201701011030"],"InBound":["LA3223-201701311535,JJ8084-201701312345,MH1-201702012135"]},{"Index":30,"Price":23321.00,"GroupTag":"BA-TP-JJ2332100","OutBound":["BA34-201612310005,BA502-201612311530,TP73-201612312325","BA34-201612310005,BA502-201612311530,TP73-201612312325"],"InBound":["JJ3399-201701311835,BA3320-201701312345,BA33-201702011855","JJ3386-201701310805,BA246-201701311730,BA33-201702011855"]},{"Index":31,"Price":23358.00,"GroupTag":"BA-TP2335800","OutBound":["BA34-201612310005,TP367-201612311225,TP73-201612312325","BA34-201612310005,TP371-201612310815,TP73-201612312325","BA34-201612310005,TP371-201612310815,TP73-201612312325","BA34-201612310005,TP367-201612311225,TP73-201612312325","BA34-201612310005,TP359-201612311340,TP73-201612312325","BA34-201612310005,BA502-201612311530,TP73-201612312325"],"InBound":["TP70-201701311810,BA501-201702011040,BA33-201702011855","TP70-201701311810,BA501-201702011040,BA33-201702011855","TP70-201701311810,BA499-201702010715,BA33-201702011855","TP70-201701311810,BA499-201702010715,BA33-201702011855","TP70-201701311810,BA501-201702011040,BA33-201702011855","TP70-201701311810,TP352-201702010950,BA33-201702011855"]},{"Index":32,"Price":23417.00,"GroupTag":"BA-TP2341700","OutBound":["BA34-201612310005,TP371-201612310815,TP73-201612312325","BA34-201612310005,TP359-201612311340,TP73-201612312325"],"InBound":["TP70-201701311810,TP352-201702010950,BA33-201702011855","TP70-201701311810,TP352-201702010950,BA33-201702011855"]},{"Index":33,"Price":23625.00,"GroupTag":"MH-BA-JJ2362500","OutBound":["MH2-201612312330,BA249-201701011140"],"InBound":["JJ3386-201701310805,BA246-201701311730,MH3-201702011000"]},{"Index":34,"Price":27954.00,"GroupTag":"TP2795400","OutBound":["TP6355-201612310110,TP6730-201612310725,TP73-201612312325"],"InBound":["TP70-201701311810,TP6731-201702011335,TP6354-201702020410"]}]');
    //grpTag = 'AF668700';
    //segTag = 'AF8398-201612312350,AF1141-201701011855,AF442-201701012335';

    var dfd = $.Deferred();

    var indexPair = [];
    var inBoundTag = [];
    for (var i = 0; i < pairingOption.length; i++) {
        var test = pairingOption[i].ServiceSource;
        if (pairingOption[i].GroupTag == grpTag && pairingOption[i].ServiceSource == serviceSource) {
            $(pairingOption[i].OutBound).each(function (index, value) {
                if (value == segTag) {
                    indexPair.push(index);
                }
            });
            $(indexPair).each(function (index, value) {
                if ($.inArray(value, inBoundTag) == -1) {
                    inBoundTag.push(pairingOption[i].InBound[value]);
                }
            });
            break;
        }
    }
    return dfd.resolve(inBoundTag);
}

$('#result-content').on('click', '.s2_mcb_ml_lr_inner', function (event) {
    if (!$(event.target).hasClass('s2_mcbml_inner_detail_container')
        && !$(event.target).hasClass('s2_hidden_full')
        && $(event.target).parents('.s2_mcbml_inner_detail_container, .s2_hidden_full').length == 0
        && !$(this).children().find("input[type=radio]").is('[disabled=disabled]'))
    {
        if (!$(this).children().find("input[type=radio]").is(':checked')) {
            var position = parseInt($(this).parents('.flight_group_container').data('gapo'));
            var stop = $(this).data('stop');
            var direction = $(this).data('direction');
            ecomclick((isNaN(position) ? 0 : position), stop, direction);
        }
        $(this).children().find("input[type=radio]").prop('checked', 'true');
        $(this).children().find("input[type=radio]").trigger('change');
    }
});
$('#result-content').on('change', '.flight_group_container .s2_mcb_ml_right_container :input[type="radio"]', function (e) {
    var inflightno = $(this).parents('.s2_mil_left').siblings('.s2_mil_right').find('.s2_mil_l_text > div').text();
    var instarttime = $(this).parents('.s2_mcbml_inner_left').siblings('.s2_mcbml_inner_right').find('.s2_mcbml_ir_left').text();
    var inendtime = $(this).parents('.s2_mcbml_inner_left').siblings('.s2_mcbml_inner_right').find('.s2_mcbml_ir_right *:not(span)').text();
    $(this).parents('.s2_mcb_ml_right_container').siblings('.s2_mcb_io_left.inbound_click').find('span').text(inflightno + " | " + instarttime + " > " + inendtime);
    var selecteddivid = $(this).closest(".flight_group_container").attr('id');
    updatePackageDtl(selecteddivid);
});

$('#result-content').on('change', '.flight_group_container .s2_mcb_ml_left_container :input[type="radio"]', function (e) {
    var outflightno = $(this).parents('.s2_mil_left').siblings('.s2_mil_right').find('.s2_mil_l_text > div').text();
    var outstarttime = $(this).parents('.s2_mcbml_inner_left').siblings('.s2_mcbml_inner_right').find('.s2_mcbml_ir_left').text();
    var outendtime = $(this).parents('.s2_mcbml_inner_left').siblings('.s2_mcbml_inner_right').find('.s2_mcbml_ir_right *:not(span)').text();
    $(this).parents('.s2_mc_border_conainer').siblings('.s2_mcb_inoutbound_cont.outbound_click').find('.s2_mcb_io_left span').text(outflightno + " | " + outstarttime + " > " + outendtime);
    var selector = $('.flight_group_container').has('#' + this.id);
    var selectorId = selector.attr('id');
    var thisDataOdo = $(this).data('odo');
    var serviceSource = $(this).data('servicesource');

    checkPairResult(selectorId, thisDataOdo, serviceSource).done(function (res) {
        // disabled flight option not available
        $(selector).find('.s2_mcb_ml_right_container :input[type="radio"]').attr('disabled', 'disabled');
        $(selector).find('.s2_mcb_ml_right_container .s2_mcb_ml_left').addClass('isInvalid');

        // enable all pairable option
        $(res).each(function (index, value) {
            var radio = $(selector).find('.s2_mcb_ml_right_container [data-odo="' + value + '"]');
            radio.removeAttr('disabled');
            radio.parents('.s2_mcb_ml_left').removeClass('isInvalid');

        });

        var invalid = $(selector).find('.s2_mcb_ml_right_container .isInvalid').find('input').is(':checked');

        if (invalid) {
            $(selector).find('.s2_mcb_ml_right_container .s2_mcb_ml_left').not('.isInvalid')
              .find('input[type="radio"]').eq(0).prop('checked', true);
        }
    });
    var selecteddivid = $(this).closest(".flight_group_container").attr('id');
    updatePackageDtl(selecteddivid);
});

var updatePackageDtl = function (selecteddivid) {
    var selecteddiv = $(".flight_group_container:not(#" + selecteddivid + ")");
    selecteddiv.find('.s2_mcb_ml_right_container input[type="radio"]').prop('checked', false);
    selecteddiv.find('.s2_mcb_ml_left_container input[type="radio"]').prop('checked', false);
    selecteddiv.find('.s2_mcb_io_left span').text("");
    var pricetopup = $("#" + selecteddivid).find(".price").text().replace(/,/g, '');
    $(".reservation-flight").text("MYR " + pricetopup);
    var totalpricefrom = parseFloat($("[name='TotalPriceFrom']").val());
    $(".reservation-total").text((totalpricefrom + parseFloat(pricetopup)).toLocaleString('en-US', {minimumFractionDigits: 2}));
}

$('#result-content').on('change', 'input[type="radio"]', function (e) {
    if ($(window).width() <= 900) {
        var lGrpSelector = $(this).parents('.flight_group_container').find('.s2_mcb_ml_left_container');
        var rGrpSelector = $(this).parents('.flight_group_container').find('.s2_mcb_ml_right_container');

        if ($(this).attr('id').search('outbound') != -1) {
            lGrpSelector.hide();
            if ($(this).parents('.s2_mc_border_conainer').siblings('.s2_mcb_inoutbound_cont.outbound_click').hasClass("boundarrow")) {
                $(this).parents('.s2_mc_border_conainer').siblings('.s2_mcb_inoutbound_cont.outbound_click').removeClass("boundarrow");
            }
            var isShow = rGrpSelector.is(':visible');
            //$('html, body').animate({
            //    scrollTop: rGrpSelector.prev().offset().top
            //}, 300);
            if (!isShow) {
                rGrpSelector.slideToggle();
            }
        }
        /* For inbound, when selected will open collesped option */
        if ($(this).attr('id').search('inbound') != -1) {
            rGrpSelector.hide();
            if ($(this).parents('.s2_mcb_ml_right_container').siblings('.mobileonly.inbound_click').hasClass("boundarrow")) {
                $(this).parents('.s2_mcb_ml_right_container').siblings('.mobileonly.inbound_click').removeClass("boundarrow");
            }
            var isShow = lGrpSelector.is(':visible');

            if (isShow) {
                lGrpSelector.slideToggle();
            }

        }

        var selectBtn = $(this).parents('.flight_group_container').find('.s2_mc_border_conainer');
        $('html, body').animate({
            scrollTop: selectBtn.offset().top
        }, 300);
    }
});
